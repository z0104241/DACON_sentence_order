# ğŸ“ DACON ë¬¸ì¥ ìˆœì„œ ë°°ì—´ AI ê²½ì§„ëŒ€íšŒ ì†”ë£¨ì…˜ (ìµœì¢… 7ìœ„)

![Python](https://img.shields.io/badge/Python-3.8%2B-blue?logo=python)
![PyTorch](https://img.shields.io/badge/PyTorch-2.1-red?logo=pytorch)
![Hugging Face](https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Models%20%26%20Libs-yellow)
![License](https://img.shields.io/badge/License-MIT-green)

ì´ ì €ì¥ì†ŒëŠ” DACONì—ì„œ ì£¼ìµœí•œ '[ë¬¸ì¥ ìˆœì„œ ë°°ì—´ AI ê²½ì§„ëŒ€íšŒ](https://dacon.io/competitions/official/236219/overview/description)'ì—ì„œ **ìµœì¢… 7ìœ„**ë¥¼ ë‹¬ì„±í•œ ì†”ë£¨ì…˜ ì½”ë“œë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. **Gemma-3-12B-it** ëª¨ë¸ì„ ê¸°ë°˜ìœ¼ë¡œ, ì£¼ì–´ì§„ ë¬¸ì¥ë“¤ì˜ ë…¼ë¦¬ì  ìˆœì„œë¥¼ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ì˜ ê°œë°œ ì „ ê³¼ì •ì„ ê¸°ë¡í•©ë‹ˆë‹¤.

<br>

## ğŸ’¡ í•µì‹¬ ì „ëµ ë° íŠ¹ì§• (Key Features)

-   **íš¨ìœ¨ì  ë¯¸ì„¸ì¡°ì •(PEFT)**: **QLoRA** ê¸°ë²•ì„ ì ìš©í•˜ì—¬, A5000 (24GB) ë‹¨ì¼ GPU í™˜ê²½ì—ì„œë„ 12Bê¸‰ ê±°ëŒ€ ì–¸ì–´ ëª¨ë¸ì„ ì•ˆì •ì ìœ¼ë¡œ íŒŒì¸íŠœë‹í–ˆìŠµë‹ˆë‹¤.
-   **ë°ì´í„° ì¦ê°•(Data Augmentation)**: **Gemma-3-27B** ëª¨ë¸ì„ í™œìš©í•œ **íŒ¨ëŸ¬í”„ë ˆì´ì§•(Paraphrasing)** ê¸°ë²•ìœ¼ë¡œ í•™ìŠµ ë°ì´í„°ì˜ ì–‘ê³¼ ì§ˆì„ ë†’ì—¬ ëª¨ë¸ì˜ ì¼ë°˜í™” ì„±ëŠ¥ì„ ê·¹ëŒ€í™”í–ˆìŠµë‹ˆë‹¤.
-   **ìë™í™” íŒŒì´í”„ë¼ì¸**: ë°ì´í„° ì¦ê°•ë¶€í„° í›ˆë ¨, ì¶”ë¡ ê¹Œì§€ ì´ì–´ì§€ëŠ” ì „ ê³¼ì •ì„ `main.py` ìŠ¤í¬ë¦½íŠ¸ í•˜ë‚˜ë¡œ ì œì–´í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„í•˜ì—¬ ì‹¤í—˜ì˜ ì¬í˜„ì„±ê³¼ íš¨ìœ¨ì„±ì„ í™•ë³´í–ˆìŠµë‹ˆë‹¤.

<br>

## ğŸš€ ì„±ëŠ¥ ê°œì„  ê³¼ì • (Experiments & Results)

ì´ˆê¸° ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸(`Qwen-8B`)ì˜ ì •í™•ë„ **0.86**ì—ì„œ ì‹œì‘í•˜ì—¬, ë‹¤ì–‘í•œ ê°€ì„¤ì„ ê²€ì¦í•˜ëŠ” ì‹¤í—˜ì„ í†µí•´ ìµœì¢… **0.874**ì˜ ì„±ëŠ¥ì„ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤.

| ë‹¨ê³„ | ì‹¤í—˜ ë‚´ìš© | ëª¨ë¸ / ë°©ë²• | ì •í™•ë„ | ë¹„ê³  |
| :--: | :--- | :--- | :---: | :--- |
| **1** | **ë² ì´ìŠ¤ë¼ì¸** | `Qwen-8B` + ê¸°ë³¸ íŒŒì¸íŠœë‹ | **0.86** | ì„±ëŠ¥ ê°œì„ ì˜ ê¸°ì¤€ì  |
| **2** | ìˆœì—´ ì¦ê°• | + Permutation Augmentation | +0.05%p | ë°ì´í„°ì˜ ì–‘ê³¼ ë‹¤ì–‘ì„± í™•ë³´ |
| **3** | ëª¨ë¸ ìŠ¤ì¼€ì¼ë§ | `Gemma-32B`ë¡œ ë³€ê²½ | ë³€í™” ì—†ìŒ | 8Bë¡œ ì¶©ë¶„í•˜ë‹¤ê³  íŒë‹¨ |
| **4** | íŒ¨ëŸ¬í”„ë ˆì´ì§• (1) | + Korean Llama 8B | **+0.1%p** | LLMì„ ì´ìš©í•œ ì¦ê°•ì˜ íš¨ê³¼ í™•ì¸ |
| **5** | **íŒ¨ëŸ¬í”„ë ˆì´ì§• (2)** | **+ Gemma-3-27B** | **+0.1%p** | **ê°€ì¥ ë†’ì€ ì„±ëŠ¥ í–¥ìƒ, ìµœì¢… ì±„íƒ** |
| **6** | í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ | LoRA `r` ê°’ ë“± ì¡°ì • | +0.04%p | ëª¨ë¸ ì„¸ë¶€ ìµœì í™” |
| **7** | ìµœì¢… ëª¨ë¸ ì„ ì • | `Gemma-3-12B-it`ë¡œ ë³€ê²½ | ë³€í™” ì—†ìŒ | ì•ˆì •ì„± ë° íš¨ìœ¨ì„± ê³ ë ¤ |

> **ìµœì¢… ê²°ë¡ **: ì´ ê³¼ì—…ì—ì„œëŠ” ëª¨ë¸ì˜ í¬ê¸°ë¥¼ ë¬´ì‘ì • í‚¤ìš°ëŠ” ê²ƒë³´ë‹¤, **ì–‘ì§ˆì˜ ë°ì´í„°ë¥¼ ì¦ê°•í•˜ì—¬ í•™ìŠµì‹œí‚¤ëŠ” ê²ƒ**ì´ ì„±ëŠ¥ í–¥ìƒì— ê°€ì¥ ê²°ì •ì ì¸ ìš”ì†Œì„ì„ ì‹¤í—˜ì ìœ¼ë¡œ ì¦ëª…í–ˆìŠµë‹ˆë‹¤.

<br>

## âš™ï¸ í”„ë¡œì íŠ¸ êµ¬ì¡° ë° íŒŒì´í”„ë¼ì¸

í”„ë¡œì íŠ¸ëŠ” 3ë‹¨ê³„ì˜ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ êµ¬ì„±ë˜ë©°, `main.py`ë¥¼ í†µí•´ ê° ë‹¨ê³„ë¥¼ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚       train.csv        â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ 1. augment_gemma.py    â”‚  (LLM Paraphrasing)
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ train_augmented_gemma.csv â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    train.csv    â”‚ + â”‚ train_aug.csv   â”œâ”€â–º 2. train.py (QLoRA) â”€â”€â–º gemma3_model
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                        â”‚
                                                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     test.csv    â”‚ + â”‚  gemma3_model   â”œâ”€â–º 3. inference.py â”€â”€â”€â”€â”€â–º predictions.csv
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<br>

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ (Tech Stack)

-   **Base Model**: `google/gemma-3-12b-it`
-   **Augmentation Model**: `google/gemma-3-27b-it` (GGUF)
-   **Core Libraries**: `PyTorch`, `transformers`, `PEFT`, `TRL`, `bitsandbytes`
-   **Data Handling**: `pandas`, `datasets`, `scikit-learn`
-   **Augmentation Engine**: `llama-cpp-python`

<br>

## ğŸ¬ ì‹œì‘í•˜ê¸° (Getting Started)

### 1. í™˜ê²½ ì„¤ì •

```bash
# 1. ì €ì¥ì†Œ ë³µì œ
git clone [https://github.com/z0104241/DACON_sentence_order.git](https://github.com/z0104241/DACON_sentence_order.git)
cd DACON_sentence_order

# 2. í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
pip install -r requirements.txt
```

### 2. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰

`main.py`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì›í•˜ëŠ” ë‹¨ê³„ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
# ë°ì´í„° ì¦ê°•ë§Œ ì‹¤í–‰
python main.py augment

# ëª¨ë¸ í›ˆë ¨ë§Œ ì‹¤í–‰
python main.py train

# ì¶”ë¡ ë§Œ ì‹¤í–‰
python main.py inference

# ëª¨ë“  ê³¼ì •ì„ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰
python main.py all
